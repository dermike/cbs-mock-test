"use strict";!function(){var e=window.cbsquestions,t=document.getElementById("alerts"),n=document.getElementById("questions"),r={userScore:0,totalQuestions:e.length,init:function(){var t=window.location.href.split("?").slice(1).join("?");return"embedded=true"===t&&document.body.classList.add("embedded"),e.forEach(function(e,t){var r=document.createElement("article"),a=void 0;r.classList.add("question"),r.setAttribute("aria-hidden","true"),r.classList.add("hide"),a="<section>\n                        <h2>"+e.header+"</h2>\n                        <p>"+e.body+'</p>\n                        <form data-question="'+t+'">\n                          <ul role="list">',e.answers.forEach(function(e){a+='<li class="checkbox" role="listitem">\n                           <label><input type="checkbox" name="0"> <span>'+e.answer+"</span></label>\n                         </li>"}),a+='</ul>\n                     </form>\n                     <div class="buttons" role="navigation">\n                       <button class="btn btn-primary answer" role="button">Answer</button>\n                       <button class="btn btn-primary next" role="button" aria-disabled="true" disabled>Next</button>\n                     </div>\n                   </section>',r.innerHTML=a,n.appendChild(r)}),r},start:function(){for(var a=document.getElementsByClassName("next"),o=document.getElementsByClassName("answer"),i=function(e){var t=e.target.parentNode.parentNode.parentNode.nextElementSibling,a=e.target.parentNode.parentNode.parentNode,o=void 0,i=void 0,s=function(e){var t='<i class="star"></i>',n='<i class="star-border"></i>',r="";r+='<div role="img" aria-label="'+e+' stars">';for(var a=0;a<e;a+=1)r+=t;for(var o=0;o<5-e;o+=1)r+=n;return r+="</div>"};r.hideFeedback(),a.classList.add("answered"),a.classList.remove("current"),a.setAttribute("aria-hidden","true"),setTimeout(function(){a.classList.add("hide")},500),t?(t.classList.remove("hide"),setTimeout(function(){t.classList.add("current"),t.setAttribute("aria-hidden","false")},100)):(i=s(r.userScore===r.totalQuestions?5:Math.round(Math.floor(r.userScore/r.totalQuestions*100)/10/2)),o='<article class="question show" id="ending">\n                          <section>\n                            <h2>Finished!</h2>\n                            '+i+"\n                            <p>You got "+r.userScore+" out of "+r.totalQuestions+' points.</p>\n                            <p><a href="javascript:document.location.reload();" class="btn btn-primary" role="button">Want to try again?</a></p>\n                          </section>\n                        </article>',setTimeout(function(){n.innerHTML=o},200))},s=function(t){var n=t.target.parentNode.parentNode.childNodes,a=t.target.parentNode.parentNode,o=void 0,i=void 0,s=void 0,d=void 0,l=void 0,c="",u=void 0,f=function(e,t){e.checked&&(d+=t.toString()),e.disabled=!0,e.setAttribute("aria-disabled","true"),s.indexOf(t)>-1&&e.nextElementSibling.classList.add("correct")};if(a.querySelector("form")&&!a.querySelectorAll("input:checked").length)return r.feedback("You need to choose an alternative before answering."),!1;for(var m=0;m<n.length;m+=1){if("FORM"===n[m].nodeName)if(a=n[m].getAttribute("data-question"),s=e[a].correctAnswer,d="",l=n[m].querySelectorAll("input"),Array.prototype.forEach.call(l,f),d===s)o=!0,r.userScore+=1;else{for(var b=0;b<d.length;b+=1)s.indexOf(d.charAt(b))>-1&&(i=!0);o=!1}if(n[m].classList&&n[m].classList.contains("buttons")){var h=n[m].querySelectorAll(".next")[0];h.disabled=!1,h.setAttribute("aria-disabled","false")}}setTimeout(function(){var e=document.querySelector(".current section"),t=e.offsetWidth,n=e.querySelector(".next"),r=n.offsetWidth,a=t-r;n.style.webkitTransform="translateX("+a+"px)",n.style.transform="translateX("+a+"px)",setTimeout(function(){n.classList.add("right"),n.style.webkitTransform="",n.style.transform=""},550)},10),t.target.disabled=!0,t.target.setAttribute("aria-disabled","true"),o?(u="alert-correct",c+="<h3>"+e[a].feedbackCorrect+"</h3>"):i&&e[a].feedbackAlmost?(u="alert-almost",c+="<h3>"+e[a].feedbackAlmost+"</h3>"):(u="alert-error",c+="<h3>"+e[a].feedbackWrong+"</h3>"),r.feedback(c,u)},d=0;d<a.length;d+=1)a[d].addEventListener("click",i,!1);for(var l=0;l<o.length;l+=1)o[l].addEventListener("click",s,!1);return t.addEventListener("click",function(e){"SPAN"!==e.target.tagName&&"BUTTON"!==e.target.tagName||r.hideFeedback()}),document.addEventListener("click",function(t){if("checkbox"===t.target.type){var n=t.target.parentNode.parentNode.parentNode.parentNode.getAttribute("data-question"),r=t.target.parentNode.parentNode.parentNode.querySelectorAll("input:checked"),a=e[n].correctAnswer.length;1===a&&a<r.length&&Array.prototype.forEach.call(r,function(e){e!==t.target&&(e.checked=!1)})}}),document.addEventListener("keydown",function(e){27===e.keyCode&&t.childNodes.length&&document.querySelector(".close").click()}),r},hideFeedback:function(){if(t.firstElementChild){var e=t.offsetHeight;t.style.webkitTransform="translateY(-"+e+"px)",t.style.transform="translateY(-"+e+"px)",setTimeout(function(){t.style.webkitTransform="",t.style.transform="",t.removeChild(t.firstElementChild)},310)}},feedback:function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"alert-error",a=document.createElement("div");a.setAttribute("role","alert"),a.classList.add("alert"),a.classList.add(n),a.innerHTML='<button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>',a.innerHTML+=e,t.innerHTML="",t.appendChild(a)},loadFonts:function(){var e=function(){var e=document.getElementsByTagName("head")[0],t=document.createElement("link");t.rel="stylesheet",t.href="css/font.css",e.appendChild(t)},t=requestAnimationFrame||mozRequestAnimationFrame||webkitRequestAnimationFrame||msRequestAnimationFrame;return t?t(e):window.addEventListener("load",e),r}};r.init().start().loadFonts()}();